<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>All Services</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h1 class="mb-4">Available Services</h1>

    <!-- Search Bar -->
    <div class="mb-4">
        <input type="text" id="search-input" class="form-control" placeholder="Search services...">
    </div>

    <!-- Filter Buttons -->
    <div class="mb-4">
        <button class="btn btn-outline-primary filter-btn" data-category="all">All</button>
        <button class="btn btn-outline-primary filter-btn" data-category="Plumbing">Plumbing</button>
        <button class="btn btn-outline-primary filter-btn" data-category="Electrical">Electrical</button>
        <button class="btn btn-outline-primary filter-btn" data-category="Cleaning">Cleaning</button>
        <button class="btn btn-outline-primary filter-btn" data-category="Carpentry">Carpentry</button>
        <!-- Add more categories as needed -->
    </div>

    <!-- Services Grid -->
    <div class="row g-4" id="services-container">
        <% if (services && services.length > 0) { %>
            <% services.forEach(service => { %>
                <div class="col-md-4 service-card" data-category="<%= service.category %>">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title"><%= service.title %></h5>
                            <p class="card-text"><%= service.description %></p>
                            <p><strong>Price:</strong> Â£<%= service.basePrice %> (<%= service.pricingType %>)</p>
                            <p><strong>Trader:</strong> <%= service.traderId.name %> - <%= service.traderId.tradeType %></p>
                            <a href="/book-service/<%= service._id %>" class="btn btn-primary btn-sm">Request Service</a>
                        </div>
                    </div>
                </div>
            <% }) %>
        <% } else { %>
            <p>No services available at the moment.</p>
        <% } %>
    </div>

    <!-- Message when no services match filter -->
    <p id="no-services-msg" class="mt-3" style="display: none;">No services match your search or category.</p>
</div>

<script>
    const filterBtns = document.querySelectorAll('.filter-btn');
    const serviceCards = document.querySelectorAll('.service-card');
    const noServicesMsg = document.getElementById('no-services-msg');
    const searchInput = document.getElementById('search-input');

    function filterServices() {
        const category = Array.from(filterBtns).find(btn => btn.classList.contains('active'))?.dataset.category.toLowerCase() || 'all';
        const searchTerm = searchInput.value.toLowerCase();
        let anyVisible = false;

        serviceCards.forEach(card => {
            const cardCategory = card.dataset.category.toLowerCase();
            const cardTitle = card.querySelector('.card-title').textContent.toLowerCase();
            const matchesCategory = (category === 'all' || cardCategory === category);
            const matchesSearch = cardTitle.includes(searchTerm);

            if (matchesCategory && matchesSearch) {
                card.style.display = 'block';
                anyVisible = true;
            } else {
                card.style.display = 'none';
            }
        });

        noServicesMsg.style.display = anyVisible ? 'none' : 'block';
    }

    // Filter buttons
    filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            filterBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            filterServices();
        });
    });

    // Search input
    searchInput.addEventListener('input', filterServices);
</script>
</body>
</html>
